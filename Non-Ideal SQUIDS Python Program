# Model of nonIdeal SQUID Circuits 

# Authors: Cliff Sun, Harshvardhan, Professor Bezryadin

import numpy as np
import matplotlib.pyplot as plt

arrayOfJunctions = [0, 1] # Where the junctions are located; must be even amount of junctions (includes 0 and 1)

criticalCurrents = np.ones(int(len(arrayOfJunctions) / 2)) # all the critical currents for each junction (length is (length of arrayOfJunctions)/2)

# Parameters for Current -> Magnetic Field, Junction Locations, Critical Currents, Initial Phase Difference, Distance between Junctions, Penetration Depth

# B is the integer value of flux quanta present in the Junction

def current(B, arrJ, arrC, y, numOfSegments): # y is initial phase difference of the whole circuit, B is the magnetic field
    curr = 0 # summation of all currents in the entire junction

    limit = int(len(arrJ) / 2)

    for n in range(limit):
        sizeOfSegment = float((arrJ[2 * n + 1] - arrJ[2 * n]) / numOfSegments)
        for i in range(numOfSegments):
            curr += arrC[n] * np.sin(y + (2 * np.pi * B) * (arrJ[2 * n] + i * sizeOfSegment)) * (1/numOfSegments)

    # differential = average distance value between the two junctions divided by the increment (allows for integration)

    # phase difference evolves according to 2 * pi * B

    # curr += (critical current element in array)(sin(y + (2 * pi * B) * length)

    return curr

def maxCurrent(B, arrayJ, arrayC):
    # Spits out the maximum current by varying the gauge invariant phase of the left end (free parameter) gamma
    Y=np.linspace(0, 2*np.pi, 100)
    dummyArray=[]
    for gamma in Y:
        dummyArray.append(current(B, arrayJ, arrayC, gamma, 5))
    return max(dummyArray)

MagField = np.linspace(0.001, 20, 5000)

IMaxPoint = []
for B in MagField:
    IMaxPoint.append(maxCurrent(B, arrayOfJunctions, criticalCurrents))

plt.plot(MagField, IMaxPoint, 'g-')
plt.xlabel('Flux')
plt.ylabel('I_max')  
plt.grid()             
plt.show()
